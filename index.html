<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>By Babaeff</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>
<style>
  :root {
    --bg:#0f172a; --card:#111827; --muted:#9ca3af; --accent:#38bdf8; --accent2:#a78bfa;
    --good:#22c55e; --warn:#f59e0b; --bad:#ef4444; --text:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif;
    background:linear-gradient(135deg,#0b1229,#0f172a 50%,#0b1229);color:var(--text);
    min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;}
  .app{width:clamp(320px,100%,1080px);background:rgba(17,24,39,.8);border:1px solid rgba(255,255,255,.06);
    border-radius:18px;box-shadow:0 10px 40px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);overflow:hidden;}
  header{padding:22px 24px 10px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:14px;flex-wrap:wrap}
  header .title{font-size:20px;font-weight:700;letter-spacing:.3px}
  .grid{display:grid;grid-template-columns: 440px 1fr;gap:18px;padding:18px;}
  @media (max-width: 1000px){.grid{grid-template-columns: 1fr;}}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);
    border-radius:14px;padding:16px;}
  .card h3{margin:0 0 10px;font-size:16px;opacity:.9}
  label{display:block;font-weight:600;margin-bottom:8px;color:#dbeafe}
  .row{display:flex; align-items:center; gap:12px; margin-bottom:10px; flex-wrap:wrap}
  input[type="number"]{
    padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);
    background:#0b1229;color:var(--text);outline:none;width:150px;
  }
  input[type="range"]{width:100%}
  .btn{appearance:none;border:1px solid rgba(255,255,255,.14);background:#0b1229;color:var(--text);
    padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;transition:0.2s}
  .btn:hover{filter:brightness(1.2)}
  footer{padding:10px 16px 18px;color:var(--muted);font-size:12px;text-align:center}
  .vizbox{display:flex;align-items:center;justify-content:center;padding:8px}
  .kpi-wrap{display:grid;grid-template-columns: repeat(3, 1fr);gap:10px;margin-top:6px}
  .kpi{background:#0b1229;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
  .kpi .label{font-size:12px;color:var(--muted);margin-bottom:4px}
  .kpi .value{font-size:20px;font-weight:800}
  .legend{display:flex;gap:12px;align-items:center;flex-wrap:wrap;font-size:12px;color:var(--muted)}
  .dot{width:10px;height:10px;border-radius:50%}
  .dot.wind{background:var(--accent)} .dot.rwy{background:var(--accent2)}
</style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">DairÉ™ Ã¼zrÉ™ kÃ¼lÉ™yin hesablanmasÄ± sistemi</div>
      <!-- PWA dÃ¼ymÉ™si buraya avtomatik É™lavÉ™ olunacaq -->
    </header>

    <div class="grid">
      <section class="card">
        <h3>Daxil et</h3>
        <label for="deg">Î´Â°: KÃ¼lÉ™yin É™smÉ™ istiqamÉ™ti (0â€“360Â°)</label>
        <div class="row">
          <input id="deg" type="number" min="0" max="360" step="1" value="45" />
          <button class="btn" id="btnSync">Hesabla</button>
          <button class="btn" id="btnReset">SÄ±fÄ±rla</button>
        </div>
        <input id="degRange" type="range" min="0" max="360" step="1" value="45" />

        <div class="row" style="margin-top:8px">
          <div>
            <label for="spd">U: KÃ¼lÉ™k sÃ¼rÉ™ti (m/s)</label>
            <input id="spd" type="number" min="0" step="1" value="5" />
          </div>
          <div class="badge">SeÃ§ilmiÅŸ zolaq (oturma): <strong id="kRwy">28</strong>Â°</div>
        </div>
        <input id="spdRange" type="range" min="0" max="25" step="1" value="5" />

        <div class="kpi-wrap" style="margin-top:6px">
          <div class="kpi"><div class="label">KB (0â€“90Â°)</div><div class="value" id="kKB">â€”</div></div>
          <div class="kpi"><div class="label">Uyan (m/s)</div><div class="value" id="kUyan">â€”</div></div>
          <div class="kpi"><div class="label">Uqar (m/s)</div><div class="value" id="kUqar">â€”</div></div>
        </div>
      </section>

      <section class="card">
        <h3>Vizual</h3>
        <div class="legend" style="margin-bottom:6px">
          <span class="dot wind"></span> KÃ¼lÉ™k oxu
          <span class="dot rwy"></span> Zolaq (28Â° â†” 208Â°)
        </div>
        <div class="vizbox">
          <svg id="viz" viewBox="0 0 400 400" width="100%" height="100%" style="max-width:560px; aspect-ratio:1/1;">
            <defs>
              <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
                <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
            </defs>
            <circle cx="200" cy="200" r="150" fill="none" stroke="rgba(255,255,255,.15)" stroke-width="2"/>
            <g id="ticks"></g>
            <line id="rwyLine" x1="200" y1="200" x2="200" y2="50" stroke="var(--accent2)" stroke-width="6" stroke-linecap="round" filter="url(#glow)"/>
            <line id="rwyLineOpp" x1="200" y1="200" x2="200" y2="350" stroke="var(--accent2)" stroke-width="6" stroke-linecap="round" opacity=".5"/>
            <text id="lbl28" x="200" y="40" text-anchor="middle" fill="rgba(167,139,250,.95)" font-size="14" font-weight="700">28Â°</text>
            <text id="lbl208" x="200" y="370" text-anchor="middle" fill="rgba(167,139,250,.65)" font-size="14" font-weight="700">208Â°</text>
            <g id="windArrow" filter="url(#glow)">
              <line x1="200" y1="65" x2="200" y2="200" stroke="var(--accent)" stroke-width="5" stroke-linecap="round"/>
              <polygon id="arrowHead" points="200,65 192,85 208,85" fill="var(--accent)"/>
            </g>
          </svg>
        </div>
      </section>
    </div>

    <footer>
      Bu sistem 2025-ci ildÉ™ BabazadÉ™ Arzu tÉ™rÉ™findÉ™n hazÄ±rlanmÄ±ÅŸdÄ±r.
    </footer>
  </div>

<script>
(function(){
  const el = {
    deg: document.getElementById('deg'),
    range: document.getElementById('degRange'),
    spd: document.getElementById('spd'),
    spdRange: document.getElementById('spdRange'),
    btnSync: document.getElementById('btnSync'),
    btnReset: document.getElementById('btnReset'),
    kRwy: document.getElementById('kRwy'),
    kKB: document.getElementById('kKB'),
    kUyan: document.getElementById('kUyan'),
    kUqar: document.getElementById('kUqar'),
    rwyLine: document.getElementById('rwyLine'),
    rwyLineOpp: document.getElementById('rwyLineOpp'),
    windArrow: document.getElementById('windArrow'),
    arrowHead: document.getElementById('arrowHead'),
    ticks: document.getElementById('ticks')
  };

  const cx=200, cy=200, R=150;
  for(let a=0;a<360;a+=10){
    const ang=(a-90)*Math.PI/180;
    const r1=(a%30===0)?R-14:R-7;
    const r2=R;
    const x1=cx+r1*Math.cos(ang),y1=cy+r1*Math.sin(ang);
    const x2=cx+r2*Math.cos(ang),y2=cy+r2*Math.sin(ang);
    const o=document.createElementNS("http://www.w3.org/2000/svg","line");
    o.setAttribute('x1',x1);o.setAttribute('y1',y1);
    o.setAttribute('x2',x2);o.setAttribute('y2',y2);
    o.setAttribute('stroke','rgba(255,255,255,.25)');
    o.setAttribute('stroke-width',(a%30===0)?2.2:1.2);
    el.ticks.appendChild(o);
  }

  function pickRunwayAuto(d){return (d<=118||d>=298)?28:208;}
  function minAngle(a,b){const d=Math.abs(a-b);return Math.min(d,360-d);}
  function computeKB(d,r){const delta=minAngle(d,r);return Math.min(delta,180-delta);}
  function fmt(x){return Number.isFinite(x)?Math.round(x):'â€”';}

  function update(){
    let d=Math.max(0,Math.min(360,Math.round(el.deg.value)));
    el.deg.value=d; el.range.value=d;
    const U=Number(el.spd.value);
    const rwy=pickRunwayAuto(d);
    const KB=computeKB(d,rwy);
    const Uyan=U*Math.sin(KB*Math.PI/180);
    const Uqar=U*Math.cos(KB*Math.PI/180);
    el.kRwy.textContent=rwy;
    el.kKB.textContent=fmt(KB)+'Â°';
    el.kUyan.textContent=fmt(Uyan);
    el.kUqar.textContent=fmt(Uqar);
  }

  el.deg.addEventListener('input',update);
  el.range.addEventListener('input',e=>{el.deg.value=e.target.value;update();});
  el.spd.addEventListener('input',update);
  el.spdRange.addEventListener('input',e=>{el.spd.value=e.target.value;update();});
  el.btnReset.addEventListener('click',()=>{el.deg.value=45;el.range.value=45;el.spd.value=5;update();});
  el.btnSync.addEventListener('click',update);
  update();
})();
</script>

<script>
// --- PWA Install dÃ¼ymÉ™si (header versiyasÄ±) ---
let deferredPrompt;
const header = document.querySelector('header');
const installBtn = document.createElement('button');
installBtn.textContent = 'ðŸ“² TÉ™tbiqi quraÅŸdÄ±r';
installBtn.className = 'btn';
installBtn.style.marginLeft = 'auto';
installBtn.disabled = true;
installBtn.style.opacity = '0.6';
header.appendChild(installBtn);

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  installBtn.disabled = false;
  installBtn.style.opacity = '1';
});

installBtn.addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    installBtn.style.display = 'none';
  } else {
    alert('Bu brauzer PWA quraÅŸdÄ±rÄ±lmasÄ±nÄ± dÉ™stÉ™klÉ™mir vÉ™ ya artÄ±q tÉ™tbiq quraÅŸdÄ±rÄ±lÄ±b.');
  }
});

window.addEventListener('appinstalled', () => {
  installBtn.style.display = 'none';
});
</script>
</body>
</html>
